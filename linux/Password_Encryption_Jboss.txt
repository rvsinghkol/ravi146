Encrypt Data Source Passwords in JBoss EAP6

Step 1: Installing Oracle Driver & configuring Data Source  -- You can skip these as this has configured.

Step 2: Generate Encrypted Password using PicketBox & Configure Data Source.

Now we need to generate the encrypted password by using PicketBox class. In this step we will be supplying the DB user password which is used to connect to database. In my case, DB password is “SecretPass”.

Execute the below steps now
a. export JBOSS_HOME=/usr1/CBS/jboss-eap-6.3/
b. export CLASSPATH=${JBOSS_HOME}/modules/system/layers/base/org/picketbox/main/picketbox-4.1.1.Final-redhat-1.jar:${JBOSS_HOME}/modules/system/layers/base/org/jboss/logging/main/jboss-logging-3.1.4.GA-redhat-2.jar:$CLASSPATH
c. java  org.picketbox.datasource.security.SecureIdentityLoginModule SecretPass
d. Encoded password: 13e0362237c93a9cda89f5b3da271521


Step 3: Now we can configure the Oracle DataSource in standalone.xml as shown below

 <datasource jta="false" jndi-name="java:/java/OracleDS" pool-name="ONSIT_CBS" enabled="true" use-ccm="false">
                    <connection-url>jdbc:oracle:thin:@10.172.214.27:1521:UTKPROD</connection-url>
                    <driver-class>oracle.jdbc.OracleDriver</driver-class>
                    <driver>ojdbc6.jar</driver>
                    <pool>
                        <min-pool-size>10</min-pool-size>
                        <max-pool-size>3000</max-pool-size>
                        <flush-strategy>IdleConnections</flush-strategy>
                    </pool>
					<security>
					<security-domain> encrypted-ds </security-domain>
					</security>
                    <validation>
                        <check-valid-connection-sql>select 1 from dual</check-valid-connection-sql>
                        <validate-on-match>true</validate-on-match>
                        <background-validation>false</background-validation>
                    </validation>
                    <timeout>
                        <set-tx-query-timeout>false</set-tx-query-timeout>
                        <blocking-timeout-millis>3000000</blocking-timeout-millis>
                        <idle-timeout-minutes>5</idle-timeout-minutes>
                        <query-timeout>0</query-timeout>
                        <use-try-lock>0</use-try-lock>
                        <allocation-retry>0</allocation-retry>
                        <allocation-retry-wait-millis>0</allocation-retry-wait-millis>
                    </timeout>
                    <statement>
                        <share-prepared-statements>false</share-prepared-statements>
                    </statement>
 </datasource>

 
Step 4: Next step is to Locate the Subsystem “urn:jboss:domain:security:1.2” & add the security-domain inside that.
 
 <security-domain name="encrypted-ds" cache-type="default">
 <authentication>
	 <login-module code="org.picketbox.datasource.security.SecureIdentityLoginModule" flag="required">
	 <module-option name="username" value="CBS"/>
	 <module-option name="password" value="13e0362237c93a9cda89f5b3da271521"/>
	 <module-option name="managedConnectionFactoryName" value="jboss.jca:service=LocalTxCM,name=ONSIT_CBS"/>
	 </login-module>
 </authentication>
 </security-domain>
 
 
 
 
 
 
 
 
 
 
 
 
 
 [standalone@localhost:9999 /] /subsystem=datasources/data-source=MySqlDS_Pool:test-connection-in-pool